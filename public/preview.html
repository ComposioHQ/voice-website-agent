<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>scratchpad — todo</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #ffffff;
      --fg: #0a0a0a;
      --muted: #666;
      --line: #111;
      --accent: #ff6a00; /* teenage engineering-esque orange */
      --grid: rgba(0,0,0,0.05);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: "Space Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      line-height: 1.45;
      letter-spacing: 0.2px;
    }

    /* subtle dot grid background */
    body::before {
      content: "";
      position: fixed; inset: 0; pointer-events: none;
      background-image:
        radial-gradient(var(--grid) 1px, transparent 1px),
        radial-gradient(var(--grid) 1px, transparent 1px);
      background-position: 0 0, 12px 12px;
      background-size: 24px 24px;
      mask-image: linear-gradient(to bottom, rgba(0,0,0,0.35), rgba(0,0,0,0.05));
    }

    .wrap {
      max-width: 920px; margin: 32px auto; padding: 24px; position: relative;
      border: 2px solid var(--line); border-radius: 12px;
      background: rgba(255,255,255,0.9);
      box-shadow: 0 10px 40px rgba(0,0,0,0.06);
    }

    header { display: grid; grid-template-columns: 1fr auto; align-items: start; gap: 12px; }
    .brand {
      display: flex; align-items: baseline; gap: 12px;
    }
    .brand b { font-weight: 700; font-size: 22px; letter-spacing: 0.5px; }
    .brand .tag { font-size: 12px; color: var(--muted); padding: 2px 8px; border: 1.5px solid var(--line); border-radius: 999px; }

    .meta { text-align: right; }
    .meta .date { font-size: 12px; color: var(--muted); }

    .progress {
      margin: 18px 0 8px; height: 10px; border: 2px solid var(--line); border-radius: 999px; position: relative;
      background: linear-gradient(90deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));
      overflow: hidden;
    }
    .progress > span { display: block; height: 100%; width: 0%; background: var(--accent); transition: width 240ms ease; }

    .legend { display: flex; justify-content: space-between; font-size: 12px; color: var(--muted); }

    .controls { margin: 18px 0 8px; display: flex; gap: 8px; flex-wrap: wrap; }
    .btn {
      border: 1.5px solid var(--line); background: #fff; color: var(--fg); padding: 6px 10px; font-size: 12px;
      border-radius: 999px; cursor: pointer; transition: transform 80ms ease, background 120ms ease;
    }
    .btn:hover { transform: translateY(-1px); background: #fff7f0; }

    .list { margin-top: 12px; border-top: 2px solid var(--line); }

    .item, details.group { 
      display: block; position: relative; padding: 14px 12px 14px 44px; border-bottom: 1.5px solid var(--line);
    }

    .check {
      appearance: none; position: absolute; left: 12px; top: 14px; width: 20px; height: 20px;
      border: 2px solid var(--line); border-radius: 6px; background: #fff; cursor: pointer;
      display: grid; place-items: center; transition: transform 80ms ease;
    }
    .check:active { transform: scale(0.95); }
    .check::after { content: ""; width: 12px; height: 12px; background: transparent; border-radius: 3px; transition: all 120ms ease; }
    .check:checked { border-color: var(--accent); }
    .check:checked::after { background: var(--accent); box-shadow: inset 0 0 0 2px #fff; }

    .title { font-weight: 700; }
    .sub { color: var(--muted); }

    .done .title, .done .sub { color: #a0a0a0; text-decoration: line-through; }

    details.group summary {
      list-style: none; cursor: pointer; outline: none;
    }
    details.group summary::-webkit-details-marker { display:none; }
    details.group summary .carat { position:absolute; left: 12px; top: 14px; width: 20px; height: 20px; border: 2px solid var(--line); border-radius: 6px; display:grid; place-items:center; font-size: 12px; }
    details.group[open] summary .carat { background: var(--accent); color: #fff; border-color: var(--accent); }

    .group-items { margin-top: 12px; margin-left: 8px; border-left: 2px dotted var(--line); }
    .subitem { padding: 10px 10px 10px 36px; position: relative; border-bottom: 1px dashed rgba(0,0,0,0.15); }
    .subitem:last-child { border-bottom: 0; }
    .subcheck {
      appearance: none; position: absolute; left: 8px; top: 10px; width: 16px; height: 16px; border: 2px solid var(--line); border-radius: 4px; background: #fff; cursor: pointer; display: grid; place-items: center;
    }
    .subcheck::after { content: ""; width: 10px; height: 10px; background: transparent; border-radius: 2px; transition: all 120ms ease; }
    .subcheck:checked { border-color: var(--accent); }
    .subcheck:checked::after { background: var(--accent); box-shadow: inset 0 0 0 2px #fff; }
    .subitem.done { color: #888; text-decoration: line-through; }

    footer { margin-top: 16px; display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: var(--muted); }
    .pill { border: 1px solid var(--line); padding: 2px 8px; border-radius: 999px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <b>todo</b>
        <span class="tag">scratchpad</span>
      </div>
      <div class="meta">
        <div class="date" id="date"></div>
      </div>
    </header>

    <div class="progress" aria-label="progress">
      <span id="progressBar"></span>
    </div>
    <div class="legend">
      <span id="count">0/0 done</span>
      <span>inspired by teenage engineering</span>
    </div>

    <div class="controls">
      <button class="btn" id="showAll">all</button>
      <button class="btn" id="showActive">active</button>
      <button class="btn" id="showDone">done</button>
      <button class="btn" id="resetDone">reset</button>
    </div>

    <section class="list" id="list">
      <!-- items injected by script -->
    </section>

    <footer>
      <span class="pill">notion → page: Scratchpad</span>
      <span>local-only; your checks are saved in this browser</span>
    </footer>
  </div>

  <script>
    const today = new Date();
    const fmt = today.toLocaleString(undefined, { weekday: 'short', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    document.getElementById('date').textContent = fmt;

    // Data from Notion → Scratchpad
    const data = [
      { id: 'review-tickets', title: 'Review current tickets/issues, prioritize high-impact ones.' },
      { id: 'code-focus', title: 'Code focus', children: [
        { id: 'code-implement', text: 'Implement features or fixes based on sprint/roadmap.' },
        { id: 'code-tests', text: 'Write tests for new and changed code.' },
        { id: 'code-refactor', text: 'Refactor small pieces of legacy code if you’re already working there (“Boy Scout Rule”).' },
      ]},
      { id: 'review-prs', title: 'Review pull requests: Check peers’ code for correctness, performance, and maintainability.' },
      { id: 'debug', title: 'Debug: Investigate and resolve errors or performance issues.' },
      { id: 'docs', title: 'Update documentation: API docs, code comments, or README changes relevant to your work.' },
      { id: 'sync', title: 'Sync with the team: Stand-up meeting or async updates.' },
      { id: 'track-time', title: 'Track time spent on different tasks (optional but helps with future estimates).' },
    ];

    const KEY = 'te-todo-scratchpad-v1';
    const state = JSON.parse(localStorage.getItem(KEY) || '{}');

    function save() { localStorage.setItem(KEY, JSON.stringify(state)); }

    function itemDone(id) { return !!state[id]; }
    function setDone(id, val) { state[id] = !!val; save(); refreshProgress(); applyFilter(); }

    function render() {
      const root = document.getElementById('list');
      root.innerHTML = '';

      data.forEach((entry, idx) => {
        if (entry.children && entry.children.length) {
          const details = document.createElement('details');
          details.className = 'group';
          details.open = true;

          const summary = document.createElement('summary');
          const carat = document.createElement('span');
          carat.className = 'carat';
          carat.textContent = '⟲';
          summary.appendChild(carat);

          const title = document.createElement('div');
          title.className = 'title';
          title.textContent = entry.title;
          summary.appendChild(title);

          details.appendChild(summary);

          const groupWrap = document.createElement('div');
          groupWrap.className = 'group-items';

          entry.children.forEach(child => {
            const row = document.createElement('div');
            row.className = 'subitem' + (itemDone(child.id) ? ' done' : '');

            const check = document.createElement('input');
            check.type = 'checkbox';
            check.className = 'subcheck';
            check.checked = itemDone(child.id);
            check.addEventListener('change', e => {
              setDone(child.id, e.target.checked);
              row.classList.toggle('done', e.target.checked);
            });

            const label = document.createElement('div');
            label.textContent = child.text;

            row.appendChild(check);
            row.appendChild(label);
            groupWrap.appendChild(row);
          });

          details.appendChild(groupWrap);
          root.appendChild(details);
        } else {
          const item = document.createElement('label');
          item.className = 'item' + (itemDone(entry.id) ? ' done' : '');

          const check = document.createElement('input');
          check.type = 'checkbox';
          check.className = 'check';
          check.checked = itemDone(entry.id);
          check.addEventListener('change', e => {
            setDone(entry.id, e.target.checked);
            item.classList.toggle('done', e.target.checked);
          });

          const title = document.createElement('div');
          title.className = 'title';
          title.textContent = entry.title;

          item.appendChild(check);
          item.appendChild(title);
          root.appendChild(item);
        }
      });

      refreshProgress();
    }

    function totals() {
      let total = 0, done = 0;
      data.forEach(entry => {
        if (entry.children) {
          entry.children.forEach(c => { total++; if (itemDone(c.id)) done++; });
        } else {
          total++; if (itemDone(entry.id)) done++;
        }
      });
      return { total, done };
    }

    function refreshProgress() {
      const { total, done } = totals();
      const pct = total ? Math.round((done / total) * 100) : 0;
      document.getElementById('progressBar').style.width = pct + '%';
      document.getElementById('count').textContent = `${done}/${total} done`;
    }

    // filtering
    let filter = 'all';
    function applyFilter() {
      const list = document.getElementById('list');
      const rows = list.children;
      for (const el of rows) {
        // For details.group, check its children; otherwise label.item
        if (el.matches('details.group')) {
          const subitems = el.querySelectorAll('.subitem');
          const visibleCount = Array.from(subitems).filter(sub => {
            const id = sub.querySelector('input').checked;
            if (filter === 'all') return true;
            if (filter === 'active') return !id;
            if (filter === 'done') return id;
          }).length;
          // show group if any subitem matches filter
          el.style.display = visibleCount ? '' : 'none';
          // hide individual subs not matching
          subitems.forEach(sub => {
            const checked = sub.querySelector('input').checked;
            if (filter === 'all') sub.style.display = '';
            if (filter === 'active') sub.style.display = checked ? 'none' : '';
            if (filter === 'done') sub.style.display = checked ? '' : 'none';
          });
        } else if (el.matches('label.item')) {
          const checked = el.querySelector('input').checked;
          if (filter === 'all') el.style.display = '';
          if (filter === 'active') el.style.display = checked ? 'none' : '';
          if (filter === 'done') el.style.display = checked ? '' : 'none';
        }
      }
    }

    document.getElementById('showAll').addEventListener('click', () => { filter = 'all'; applyFilter(); });
    document.getElementById('showActive').addEventListener('click', () => { filter = 'active'; applyFilter(); });
    document.getElementById('showDone').addEventListener('click', () => { filter = 'done'; applyFilter(); });
    document.getElementById('resetDone').addEventListener('click', () => {
      for (const k in state) delete state[k];
      save();
      render();
      applyFilter();
    });

    render();
    applyFilter();
  </script>
</body>
</html>